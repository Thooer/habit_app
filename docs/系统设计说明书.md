# 习惯打卡App - 系统设计说明书

## 目录
1. [系统架构设计](#1-系统架构设计)
2. [UI/UX设计](#2-uiux设计)
3. [数据库设计](#3-数据库设计)
4. [模块设计](#4-模块设计)
5. [技术选型](#5-技术选型)

---

## 1. 系统架构设计

### 1.1 总体架构

本系统采用**前端单页应用（SPA）架构**，基于**三层架构模式**：

```
┌─────────────────────────────────────────┐
│         展示层 (Presentation)            │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐ │
│  │ 习惯页面 │  │ 统计页面 │  │ 成就页面 │ │
│  └─────────┘  └─────────┘  └─────────┘ │
│         index.html + CSS                │
└─────────────────────────────────────────┘
                    ↕
┌─────────────────────────────────────────┐
│         业务逻辑层 (Business Logic)      │
│  ┌──────────────────────────────────┐  │
│  │  应用控制器 (app.js)              │  │
│  │  - 页面切换                       │  │
│  │  - 事件处理                       │  │
│  │  - 数据渲染                       │  │
│  │  - 业务逻辑                       │  │
│  └──────────────────────────────────┘  │
└─────────────────────────────────────────┘
                    ↕
┌─────────────────────────────────────────┐
│         数据访问层 (Data Access)         │
│  ┌──────────────────────────────────┐  │
│  │  Database 类                      │  │
│  │  - CRUD操作                       │  │
│  │  - 数据计算                       │  │
│  │  - LocalStorage封装               │  │
│  └──────────────────────────────────┘  │
└─────────────────────────────────────────┘
                    ↕
┌─────────────────────────────────────────┐
│         数据存储层 (Storage)             │
│         LocalStorage (浏览器本地)        │
└─────────────────────────────────────────┘
```

### 1.2 架构特点

#### 1.2.1 单页应用（SPA）
- **优势**：
  - 页面切换无刷新，用户体验流畅
  - 减少服务器请求，提升性能
  - 前后端分离，易于维护
  
#### 1.2.2 本地优先（Local-First）
- **优势**：
  - 完全离线可用
  - 数据响应速度快
  - 无需服务器成本
  - 用户数据隐私安全

#### 1.2.3 PWA架构
- **组件**：
  - Manifest.json：应用配置
  - Service Worker：离线缓存
  - 响应式设计：适配多端
  
### 1.3 技术架构图

```
┌──────────────────────────────────────────────┐
│              用户设备                         │
│  ┌────────────────────────────────────────┐ │
│  │         浏览器/WebView                  │ │
│  │  ┌──────────────────────────────────┐ │ │
│  │  │      渲染引擎                     │ │ │
│  │  │  - HTML Parser                   │ │ │
│  │  │  - CSS Parser                    │ │ │
│  │  │  - JavaScript Engine             │ │ │
│  │  └──────────────────────────────────┘ │ │
│  │  ┌──────────────────────────────────┐ │ │
│  │  │      Web APIs                    │ │ │
│  │  │  - LocalStorage API              │ │ │
│  │  │  - Service Worker API            │ │ │
│  │  │  - DOM API                       │ │ │
│  │  └──────────────────────────────────┘ │ │
│  └────────────────────────────────────────┘ │
│  ┌────────────────────────────────────────┐ │
│  │         本地存储                        │ │
│  │  - LocalStorage (持久化数据)           │ │
│  │  - Cache Storage (静态资源)            │ │
│  └────────────────────────────────────────┘ │
└──────────────────────────────────────────────┘
```

---

## 2. UI/UX设计

### 2.1 设计原则

#### 2.1.1 简洁性（Simplicity）
- 界面元素精简，避免信息过载
- 每个页面聚焦单一任务
- 使用清晰的视觉层次

#### 2.1.2 一致性（Consistency）
- 统一的配色方案
- 一致的交互模式
- 标准化的组件样式

#### 2.1.3 反馈性（Feedback）
- 每个操作都有即时反馈
- 使用动画增强交互感
- 清晰的状态提示

#### 2.1.4 可访问性（Accessibility）
- 合理的字体大小（最小14px）
- 足够的点击区域（最小44×44px）
- 高对比度的配色

### 2.2 色彩设计

#### 2.2.1 主色调
```css
--primary: #6366f1        /* 主题色-靛蓝 */
--primary-dark: #4f46e5   /* 主题色-深靛蓝 */
--success: #10b981        /* 成功色-绿色 */
--warning: #f59e0b        /* 警告色-橙色 */
--danger: #ef4444         /* 危险色-红色 */
```

#### 2.2.2 中性色
```css
--bg: #f8fafc            /* 背景色-浅灰 */
--card-bg: #ffffff       /* 卡片背景-白色 */
--text: #1e293b          /* 主文本-深灰 */
--text-secondary: #64748b /* 次要文本-中灰 */
--border: #e2e8f0        /* 边框色-浅灰 */
```

#### 2.2.3 渐变色
- 头部渐变：`linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)`
- 统计卡片：`linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)`
- 成就卡片：`linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%)`

### 2.3 页面布局

#### 2.3.1 习惯列表页
```
┌─────────────────────────────┐
│  ✨ 习惯打卡                 │ ← 顶部栏（渐变背景）
├─────────────────────────────┤
│                             │
│  ┌─────────────────────┐   │
│  │ ⭐ 早起              │   │ ← 习惯卡片
│  │ 连续7天 · 累计30次   │   │
│  │                  ○  │   │ ← 打卡按钮
│  └─────────────────────┘   │
│                             │
│  ┌─────────────────────┐   │
│  │ ⭐ 跑步              │   │
│  │ 连续3天 · 累计15次   │   │
│  │                  ✓  │   │ ← 已打卡
│  └─────────────────────┘   │
│                             │
├─────────────────────────────┤
│   🏠      📊      🏆        │ ← 底部导航
└─────────────────────────────┘
                          [+]  ← 浮动按钮
```

#### 2.3.2 统计页面
```
┌─────────────────────────────┐
│  数据统计                    │
├─────────────────────────────┤
│  ┌──────┐  ┌──────┐         │
│  │  4   │  │  45  │         │ ← 统计卡片
│  │习惯数 │  │累计  │         │
│  └──────┘  └──────┘         │
│  ┌──────┐  ┌──────┐         │
│  │  7   │  │  3   │         │
│  │最长  │  │今日  │         │
│  └──────┘  └──────┘         │
│                             │
│  ┌─────────────────────┐   │
│  │ ⭐ 早起              │   │ ← 详细统计
│  │  7天  30次  80%     │   │
│  └─────────────────────┘   │
│                             │
├─────────────────────────────┤
│   🏠      📊      🏆        │
└─────────────────────────────┘
```

#### 2.3.3 成就页面
```
┌─────────────────────────────┐
│  我的成就                    │
├─────────────────────────────┤
│  ┌──────┐  ┌──────┐         │
│  │  🌟  │  │  🔥  │         │ ← 成就卡片
│  │初次尝试│  │坚持3天│         │
│  │ 1天  │  │ 3天  │         │
│  │✓已解锁│  │✓已解锁│         │
│  └──────┘  └──────┘         │
│  ┌──────┐  ┌──────┐         │
│  │  🏅  │  │  💪  │         │
│  │一周达人│  │半月英雄│         │
│  │ 7天  │  │ 15天 │         │
│  │✓已解锁│  │未解锁│         │
│  └──────┘  └──────┘         │
│                             │
├─────────────────────────────┤
│   🏠      📊      🏆        │
└─────────────────────────────┘
```

### 2.4 交互设计

#### 2.4.1 添加习惯流程
```
用户点击"+"按钮
    ↓
弹出对话框（带遮罩）
    ↓
用户输入习惯名称
    ↓
点击"添加"按钮
    ↓
对话框关闭（淡出动画）
    ↓
列表刷新（新习惯出现）
    ↓
显示成功提示（Toast）
```

#### 2.4.2 打卡流程
```
用户点击打卡按钮
    ↓
检查是否已打卡
    ↓
├─ 未打卡 → 记录打卡
│           ↓
│       按钮变绿+✓
│           ↓
│       缩放动画
│           ↓
│       显示"打卡成功"
│
└─ 已打卡 → 显示"今天已打卡"
```

### 2.5 响应式设计

#### 2.5.1 断点设置
- 移动端：< 768px
- 平板端：768px - 1024px
- 桌面端：> 1024px

#### 2.5.2 适配策略
- 移动端：单列布局，底部导航
- 平板端：双列布局，侧边导航（可选）
- 桌面端：居中显示，最大宽度600px

---

## 3. 数据库设计

### 3.1 存储方案

#### 3.1.1 LocalStorage
- **容量**：5-10MB（各浏览器不同）
- **格式**：JSON字符串
- **持久化**：永久保存（除非用户清除）
- **同步**：同步API，性能优秀

### 3.2 数据模型

#### 3.2.1 ER图
```
┌─────────────────┐
│     Habit       │
├─────────────────┤
│ id (PK)         │
│ name            │
│ icon            │
│ createdAt       │
└─────────────────┘
        │
        │ 1
        │
        │ has
        │
        │ N
        ↓
┌─────────────────┐
│  CheckRecord    │
├─────────────────┤
│ id (PK)         │
│ habitId (FK)    │
│ date            │
└─────────────────┘
```

### 3.3 表结构设计

#### 3.3.1 habits表
| 字段 | 类型 | 约束 | 说明 |
|------|------|------|------|
| id | Number | PK, NOT NULL | 主键，时间戳生成 |
| name | String | NOT NULL | 习惯名称，最大50字符 |
| icon | String | DEFAULT '⭐' | emoji图标 |
| createdAt | String | NOT NULL | ISO 8601格式 |

**示例数据**：
```json
{
  "id": 1737561600000,
  "name": "早起",
  "icon": "⭐",
  "createdAt": "2026-01-22T12:00:00.000Z"
}
```

#### 3.3.2 check_records表
| 字段 | 类型 | 约束 | 说明 |
|------|------|------|------|
| id | Number | PK, NOT NULL | 主键，时间戳生成 |
| habitId | Number | FK, NOT NULL | 外键，关联habits.id |
| date | String | NOT NULL | YYYY-MM-DD格式 |

**唯一约束**：(habitId, date) - 同一习惯同一天只能打卡一次

**示例数据**：
```json
{
  "id": 1737561601000,
  "habitId": 1737561600000,
  "date": "2026-01-22"
}
```

### 3.4 数据存储结构

```json
{
  "habits": [
    {
      "id": 1737561600000,
      "name": "早起",
      "icon": "⭐",
      "createdAt": "2026-01-22T12:00:00.000Z"
    },
    {
      "id": 1737561700000,
      "name": "跑步",
      "icon": "⭐",
      "createdAt": "2026-01-22T12:10:00.000Z"
    }
  ],
  "records": [
    {
      "id": 1737561601000,
      "habitId": 1737561600000,
      "date": "2026-01-22"
    },
    {
      "id": 1737561602000,
      "habitId": 1737561600000,
      "date": "2026-01-21"
    },
    {
      "id": 1737561603000,
      "habitId": 1737561700000,
      "date": "2026-01-22"
    }
  ]
}
```

---

**文档编写**: AI辅助生成  
**最后更新**: 2026年1月22日

